"0","CREATE OR REPLACE VIEW AirlineIncidentData AS
SELECT
  Airline,
  Num_Incidents,
  Avg_Delay_mins
FROM (
  SELECT 
    a.name AS Airline,
    COUNT(i.inId) AS Num_Incidents,
    ROUND(AVG(f.delay), 2) AS Avg_Delay_mins
  FROM Incident i
  LEFT JOIN Flight f
    ON i.fId = f.fId
  LEFT JOIN Airline a
    ON f.alId = a.alId
  GROUP BY a.alId
  ORDER BY a.alId
) AS subquery"
